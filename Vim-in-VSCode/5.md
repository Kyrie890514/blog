---
outline: deep
---

# 操作

在上面两章我们了解了如何在 Normal mode 下快速移动光标，移动的目的是对内容进行修改，除了进入 Insert mode 修改，我们还可以直接在 Normal mode 下进行一些操作，这会在本章介绍。

## 语法

通常来说，我们会使用位于键盘右上角的 `Backspace` 键来进行删除操作，当我很讨厌这个按键，因为每次使用都要将右手离开主键盘区；在 Vim 中，我们可以使用 `d` 来进行删除操作。

操作即 operator，其基本语法为：

- `{operator}{motion}`

- `{operator}{count}{motion}`

- `{count}{operator}{motion}`

也就是说，我们可以使用 `dl` 删除右边 1 个字符，使用 `d5l` 或 `5dl` 删除右边 5 个字符。

下面是一些常用的组合：

- `d2w`: 删除至后两个 word 前

- `d5j`: 删除当前行和下面 5 行

- `dt(`: 删除当前光标到下一个 `(` 之间的内容

- `df(`: 删除当前光标到下一个 `(` 之间的内容，包含 `(`

- `d$`: 删除当前光标到该行末尾的内容

- `d^`: 删除当前光标到该行开头的内容

> 我个人不建议在 Vim 中频繁的使用 {count}，因为数数本身是一个效率低下的过程，会增加心智负担，打断思维的流畅性。

## 常用操作

下面是一些 Vim 中常用的操作(operator)，均可结合上面的语法使用。

- `c`: 删除相应的内容并进入 Insert mode，相当于在 `d` 操作后按下 `i`

- `y`: 复制

- `p`: 粘贴

- `g~`: 切换大小写

- `gu`: 切换至小写

- `gU`: 切换至大写

- `>`: 将当前行右移，增加缩进

- `<`: 将当前行左移，减少缩进

- `=`: 格式化代码

注意，使用 `c` 和 `d` 删除的内容也会被复制，因此在使用 `y` 操作复制后再使用 `c` 或 `d`操作，会顶替前面 `y` 复制的内容。

> 默认情况下 Vim 的复制粘贴与系统的不相通，这对 CV 大法不是很友好，为了能够使用，需要在 `setting.json` 中添加下述配置。
>
> ```json
> "vim.useSystemClipboard": true
> ```

## shorthand

除了上面提到的语法，Vim 还提供了一些更加简略的用法。

### double

连续按两下操作的按键，相当于对行进行相应的操作。

- `dd`: 删除光标所在行

- `cc`: 删除光标所在行并进入 Insert mode

- `yy`: 复制光标所在行

- `g~~`: 切换光标所在行所有字符的大小写

- `guu`: 切换光标所在行所有字符至小写

- `gUU`: 切换光标所在行所有字符至大写

- `>>`: 将当前行右移，增加缩进

- `<<`: 将当前行左移，减少缩进

- `==`: 格式化光标所在行的代码

### capitalize

除此之外，这些操作的大写按键也有不同的意义。

- `D`: 删除当前光标到该行末尾的内容

- `C`: 删除当前光标到该行末尾的内容并进入 Insert mode

- `Y`: 复制光标所在行，相当于 `yy`

- `P`: 在当前光标前面粘贴

### character

针对单个字符的修改，有更加简便的操作方式。

- `x`: 删除光标所在的字符，相当于 `dl`

- `X`: 删除光标所在的前一个字符，相当于 `dh`

- `s`：删除光标所在字符并进入 Insert mode

- `S`：删除光标所在行的所有字符并进入 Insert mode

- `r{character}`: 将光标所在的字符替换成 \{character}

- `R{character}`: 依次替换光标所在及之后的字符，注意下方左侧的标志为为 `REPLACE`，替换完成后可以通过 `<Esc>` 回到 Normal mode。

- `~`: 切换光标所在字符的大小写

> 这里不建议使用 `s` 和 `S`，因为这两个按键会被 vim-sneak 占用。

## dot

Vim 还提供了 `.` 来让我们更一步简化按键，它的作用是重复上一次的修改操作，通常是 `d` 和 `c`。

也就是说，当我们通过 `dd` 删除一行内容后，如果还想再删除一行，就可以通过按下 `.` 来完成。

## 撤销和重做

- `u`: 撤销上一次修改操作

- `<Ctrl-r>`: 恢复上一次的撤销

> 对于 Vim 来说，从 Normal mode 进入 Insert mode 输入文字，退出回到 Normal mode 为一次操作，它不会记录在 Insert mode 下的删除操作；但是如果在 Insert mode 下移动光标，则会增加一次操作。
>
> 我会将这两个按键映射成 VSCode 的撤销/重做功能，即 `<Cmd-z>` 和 `<Shift-Cmd-z>` 的功能。
>
> ```json
> "vim.normalModeKeyBindingsNonRecursive": [
> 	{
> 		"before": ["u"],
> 		"commands": ["undo"]
> 	},
> 	{
> 		"before": ["<C-r>"],
> 		"commands": ["redo"]
> 	},
> ]
> ```
